{"version":3,"file":"DocumentListWrapper.js","names":["DocumentListWrapper","type","filter","params","showIncrements","resetOrderTransaction","toast","useToast","useEffect","title","status","push","schemaIsInvalid","useMemo","typeSchema","schema","get","fields","some","field","name","ORDER_FIELD_NAME","propTypes","PropTypes","bool","isRequired","string","object","shape","defaultProps"],"sources":["../src/DocumentListWrapper.js"],"sourcesContent":["import PropTypes from 'prop-types'\nimport React, {useMemo, useEffect} from 'react'\nimport schema from 'part:@sanity/base/schema'\nimport {useToast} from '@sanity/ui'\nimport {PaneRouterContext} from '@sanity/desk-tool'\n\nimport DocumentListQuery from './DocumentListQuery'\nimport {OrderableContext} from './OrderableContext'\n\nimport {ORDER_FIELD_NAME} from './helpers/constants'\nimport Feedback from './Feedback'\n\n// 1. Validate first that the schema has been configured for ordering\n// 2. Setup context for showIncrements\nexport default function DocumentListWrapper({\n  type,\n  filter,\n  params,\n  showIncrements,\n  resetOrderTransaction,\n}) {\n  const toast = useToast()\n\n  useEffect(() => {\n    if (resetOrderTransaction?.title && resetOrderTransaction?.status) {\n      toast.push(resetOrderTransaction)\n    }\n    /* eslint-disable-next-line react-hooks/exhaustive-deps */\n  }, [resetOrderTransaction])\n\n  const schemaIsInvalid = useMemo(() => {\n    // Option not passed\n    if (!type) {\n      return (\n        <>\n          No <code>type</code> was configured\n        </>\n      )\n    }\n\n    const typeSchema = schema.get(type)\n\n    // Schema not found\n    if (!typeSchema) {\n      return (\n        <>\n          Schema <code>{type}</code> not found\n        </>\n      )\n    }\n\n    // Schema lacks an order field\n    if (!typeSchema.fields.some((field) => field?.name === ORDER_FIELD_NAME)) {\n      return (\n        <>\n          Schema <code>{type}</code> must have an <code>order</code> field of type{' '}\n          <code>string</code>\n        </>\n      )\n    }\n\n    // Schema's order field is not a string\n    if (\n      typeSchema.fields.some(\n        (field) => field?.name === ORDER_FIELD_NAME && field?.type?.name !== 'string'\n      )\n    ) {\n      return (\n        <>\n          <code>{ORDER_FIELD_NAME}</code> field on Schema <code>{type}</code> must be{' '}\n          <code>string</code> type\n        </>\n      )\n    }\n\n    return ``\n  }, [type])\n\n  if (schemaIsInvalid) {\n    return <Feedback>{schemaIsInvalid}</Feedback>\n  }\n\n  return (\n    <OrderableContext.Provider value={{showIncrements}}>\n      <DocumentListQuery type={type} filter={filter} params={params} />\n    </OrderableContext.Provider>\n  )\n}\n\nDocumentListWrapper.propTypes = {\n  showIncrements: PropTypes.bool.isRequired,\n  type: PropTypes.string.isRequired,\n  filter: PropTypes.string,\n  params: PropTypes.object,\n  resetOrderTransaction: PropTypes.shape({\n    title: PropTypes.string,\n    status: PropTypes.string,\n  }).isRequired,\n}\n\nDocumentListWrapper.defaultProps = {\n  filter: ``,\n  params: {},\n}\n"],"mappings":"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"}