{"version":3,"file":"orderRankField.js","names":["client","sanityClient","withConfig","apiVersion","orderRankField","config","type","Error","title","readOnly","hidden","name","ORDER_FIELD_NAME","initialValue","lastDocOrderRank","fetch","order","initialRank"],"sources":["../../src/fields/orderRankField.js"],"sourcesContent":["import sanityClient from 'part:@sanity/base/client'\nimport {ORDER_FIELD_NAME} from '../helpers/constants'\nimport initialRank from '../helpers/initialRank'\n\nconst client = sanityClient.withConfig({apiVersion: `2021-05-19`})\n\nexport const orderRankField = (config = {}) => {\n  if (!config?.type) {\n    throw new Error(\n      `\n      \"type\" not defined in orderRankField parameter object. \n      Example: orderRankField({type: 'category'})\n      `\n    )\n  }\n\n  const {type} = config\n\n  return {\n    title: 'Order Rank',\n    readOnly: true,\n    hidden: true,\n    ...config,\n    name: ORDER_FIELD_NAME,\n    type: 'string',\n    initialValue: async () => {\n      const lastDocOrderRank = await client.fetch(\n        `*[_type == $type]|order(@[$order] desc)[0][$order]`,\n        {type, order: ORDER_FIELD_NAME}\n      )\n\n      return initialRank(lastDocOrderRank)\n    },\n  }\n}\n"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;;;;;AAEA,IAAMA,MAAM,GAAGC,eAAA,CAAaC,UAAb,CAAwB;EAACC,UAAU;AAAX,CAAxB,CAAf;;AAEO,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAiB;EAAA,IAAhBC,MAAgB,uEAAP,EAAO;;EAC7C,IAAI,EAACA,MAAD,aAACA,MAAD,eAACA,MAAM,CAAEC,IAAT,CAAJ,EAAmB;IACjB,MAAM,IAAIC,KAAJ,gIAAN;EAMD;;EAED,IAAOD,IAAP,GAAeD,MAAf,CAAOC,IAAP;EAEA;IACEE,KAAK,EAAE,YADT;IAEEC,QAAQ,EAAE,IAFZ;IAGEC,MAAM,EAAE;EAHV,GAIKL,MAJL;IAKEM,IAAI,EAAEC,2BALR;IAMEN,IAAI,EAAE,QANR;IAOEO,YAAY;MAAA,sCAAE,aAAY;QACxB,IAAMC,gBAAgB,SAASd,MAAM,CAACe,KAAP,uDAE7B;UAACT,IAAD;UAAOU,KAAK,EAAEJ;QAAd,CAF6B,CAA/B;QAKA,OAAO,IAAAK,oBAAA,EAAYH,gBAAZ,CAAP;MACD,CAPW;;MAAA;QAAA;MAAA;;MAAA;IAAA;EAPd;AAgBD,CA5BM"}